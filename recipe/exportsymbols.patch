diff --git a/poppler/GlobalParams.h b/poppler/GlobalParams.h
index 980dc87..1b90301 100644
--- a/poppler/GlobalParams.h
+++ b/poppler/GlobalParams.h
@@ -65,7 +65,14 @@ class SysFontList;
 //------------------------------------------------------------------------

 // The global parameters object.
-extern std::unique_ptr<GlobalParams> POPPLER_PRIVATE_EXPORT globalParams;
+#ifdef _COMPILING_POPPLER
+// cmake's WINDOWS_EXPORT_ALL_SYMBOLS doesn't extend to data unfortunately
+// so we must to this by hand
+extern __declspec(dllexport) std::unique_ptr<GlobalParams> globalParams;
+#else
+extern __declspec(dllimport) std::unique_ptr<GlobalParams> globalParams;
+#endif
+

 //------------------------------------------------------------------------

diff --git a/poppler/PDFDocEncoding.h b/poppler/PDFDocEncoding.h
index 01f3815..278a910 100644
--- a/poppler/PDFDocEncoding.h
+++ b/poppler/PDFDocEncoding.h
@@ -32,7 +32,11 @@

 class GooString;

-extern const Unicode POPPLER_PRIVATE_EXPORT pdfDocEncoding[256];
+#ifdef _COMPILING_POPPLER
+extern __declspec(dllexport) const Unicode pdfDocEncoding[256];
+#else
+extern __declspec(dllimport) const Unicode pdfDocEncoding[256];
+#endif

 char POPPLER_PRIVATE_EXPORT *pdfDocEncodingToUTF16(const std::string &orig, int *length);